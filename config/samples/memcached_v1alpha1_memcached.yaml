apiVersion: memcached.c5c3.io/v1alpha1
kind: Memcached
metadata:
  labels:
    app.kubernetes.io/name: memcached-operator
    app.kubernetes.io/managed-by: kustomize
  name: memcached-sample
spec:
  replicas: 3
  # TODO: Update image tag to a specific digest for production use.
  image: "memcached:1.6"
  resources:
    requests:
      cpu: "100m"
      memory: "128Mi"
    limits:
      cpu: "500m"
      memory: "256Mi"
  memcached:
    maxMemoryMB: 128
    maxConnections: 2048
    threads: 4
    maxItemSize: "2m"
  highAvailability:
    antiAffinityPreset: "soft"
    podDisruptionBudget:
      enabled: true
      minAvailable: 1
  monitoring:
    enabled: true
    serviceMonitor:
      interval: "30s"
  security:
    podSecurityContext:
      runAsNonRoot: true
      fsGroup: 11211
      seccompProfile:
        type: RuntimeDefault
    containerSecurityContext:
      runAsUser: 1000
      runAsNonRoot: true
      readOnlyRootFilesystem: true
      allowPrivilegeEscalation: false
      capabilities:
        drop:
          - ALL
    # SASL authentication (optional):
    # sasl:
    #   enabled: true
    #   credentialsSecretRef:
    #     name: memcached-sasl-credentials
